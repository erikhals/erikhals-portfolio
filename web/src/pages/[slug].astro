---
import { getProjects, getProject } from '../../utils/sanity'
import PortableText from '../../components/PortableText.astro'
import MainImage from '../../components/MainImage.astro'
import { urlForImage } from '../../utils/urlForImage';
import BaseLayout from '../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const projects = await getProjects()

  return projects.map((project) => {
    return {
      params: {slug: project.slug.current},
      props: { ...project }
    }
  });
}

const { slug } = Astro.params
const { title, category, role, mainImage, body } = Astro.props
console.log(category)

---
<BaseLayout url=`/${slug}`>
<h1>{title}</h1>
{
   mainImage ? (
      <img
        class="card__cover"
        src={urlForImage(mainImage).width(500).height(300).url()}
        alt="Cover image"
      />
    ) : (
      <div class="card__cover--none" />
    )
}
<p>{role}</p>
<PortableText portableText={body} />
</BaseLayout>
